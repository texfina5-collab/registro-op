<!-- ... mismo HTML ... -->

<script>
  const form = document.getElementById('formOP');
  const resultado = document.getElementById('resultado');
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxeZAFS-Uy4-EZd92QkvpkU5zIbHp5L2u4-GDKYVpGaGRgu20G1ftUSvay02SjZs3pX/exec';

  form.addEventListener('submit', async (e) => {
    e.preventDefault();
    resultado.textContent = 'Enviando...';
    resultado.className = 'resultado';

    const data = {
      generadoPor: document.getElementById('generadoPor').value,
      categoriaOP: document.getElementById('categoriaOP').value,
      tipoOP: document.getElementById('tipoOP').value,
      opReferencia: document.getElementById('opReferencia').value,
      repoAdicional: document.getElementById('repoAdicional').value,
      bookingTemporada: document.getElementById('bookingTemporada').value,
      pedidoCliente: document.getElementById('pedidoCliente').value,
      fechaPedido: document.getElementById('fechaPedido').value,
      fechaOP: document.getElementById('fechaOP').value,
      grupoClientes: document.getElementById('grupoClientes').value,
      subcliente: document.getElementById('subcliente').value,
      articulo: document.getElementById('articulo').value,
      tipoListado: document.getElementById('tipoListado').value,
      kgNetos: parseFloat(document.getElementById('kgNetos').value) || 0,
      kgBrutos: parseFloat(document.getElementById('kgBrutos').value) || 0,
      estadoOP: document.getElementById('estadoOP').value,
      motivoIncompleta: document.getElementById('motivoIncompleta').value,
      email: document.getElementById('email').value,
      comentarios: document.getElementById('comentarios').value,
      motivoDemora: document.getElementById('motivoDemora').value,
      reservaVinculada: document.getElementById('reservaVinculada').value,
      motivoReposicion: document.getElementById('motivoReposicion').value,
      hilosEspeciales: document.getElementById('hilosEspeciales').value,
      referenciaBOBCGO: document.getElementById('referenciaBOBCGO').value
    };

    try {
      const response = await fetch(SCRIPT_URL, {
        method: 'POST',
        body: JSON.stringify(data),
        headers: { 'Content-Type': 'text/plain' }
      });

      const result = await response.json();

      if (result.status === 'success') {
        resultado.innerHTML = `<strong>¡OP registrada!</strong> N°: <strong>${result.op}</strong>`;
        resultado.className = 'resultado success';
        form.reset();
      } else {
        throw new Error(result.message);
      }
    } catch (error) {
      resultado.innerHTML = `<strong>Error:</strong> ${error.message}`;
      resultado.className = 'resultado error';
    }
  });
</script>
